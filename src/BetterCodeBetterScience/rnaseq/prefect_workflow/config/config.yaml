# Configuration for Prefect scRNA-seq immune aging workflow
#
# Usage:
#   python -m BetterCodeBetterScience.rnaseq.prefect_workflow.run_workflow --config /path/to/config.yaml
#
# Override any parameter via CLI:
#   python ... --dataset-name MyDataset --force-from 5

# Dataset configuration
dataset_name: "OneK1K"
url: "https://datasets.cellxgene.cziscience.com/a3f5651f-cd1a-4d26-8165-74964b79b4f2.h5ad"

# Step 2: Filtering parameters
filtering:
  cutoff_percentile: 1.0
  min_cells_per_celltype: 10
  percent_donors: 0.95

# Step 3: QC parameters
qc:
  min_genes: 200
  max_genes: 6000
  min_counts: 500
  max_counts: 30000
  max_hb_pct: 5.0
  expected_doublet_rate: 0.06

# Step 4: Preprocessing parameters
preprocessing:
  target_sum: 10000
  n_top_genes: 3000
  batch_key: "donor_id"

# Step 5: Dimensionality reduction parameters
dimred:
  batch_key: "donor_id"
  n_neighbors: 30
  n_pcs: 40

# Step 6: Clustering parameters
clustering:
  resolution: 1.0

# Step 7: Pseudobulking parameters
pseudobulk:
  group_col: "cell_type"
  donor_col: "donor_id"
  metadata_cols:
    - "development_stage"
    - "sex"
  min_cells: 10

# Steps 8-11: Per-cell-type analysis parameters
differential_expression:
  design_factors:
    - "age_scaled"
    - "sex"
  n_cpus: 8

pathway_analysis:
  gene_sets:
    - "MSigDB_Hallmark_2020"
  n_top: 10

overrepresentation:
  gene_sets:
    - "MSigDB_Hallmark_2020"
  padj_threshold: 0.05
  n_top: 10

predictive_modeling:
  n_splits: 5

# Minimum samples per cell type for per-cell-type analysis
min_samples_per_cell_type: 10
